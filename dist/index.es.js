var r,e,n=1229472850,t=1229278788,o=1229209940,i=1347179589,f=1951551059,h=1732332865,d=3,a={0:1,2:3,3:1,4:2,6:4},w=!1,u=!1,c=!1,l=[],p=0,g={};function I(t){for(w=!1,u=!1,c=!1,l=[],p=0,r=0,e=t,function(){for(var e=[137,80,78,71,13,10,26,10],n=s(e.length),t=0;t<e.length;t++)if(n[t]!==e[t])throw new Error("Invalid file signature. Index: "+r)}();r<e.byteLength;){var o=v(e,r);if(r+=4,o>e.byteLength-r)throw new Error("Invalid chunk length. Index: "+r);var i=e.slice(r,r+4+o),f=v(e,r);r+=4;for(var h="",d=4;d>0;d--)h+=String.fromCharCode(e[r-d]);var a=Boolean(32&i[0]);if(!w&&f!==n)throw new Error("Expected IHDR on beggining. Index: "+r);var I=s(o),E=g[f];if(null==E){if(!a)throw new Error("Unsupported critical chunk type "+h+". Index: "+r);r+=4}else{E(I);var b=x(e,r);r+=4;var U=y(i);if(U!==b)throw new Error("Crc error - "+b+" - "+U+". Index: "+r)}}if(!w)throw new Error("Parsing ended without finding the IHDR chunk. Index: "+r);if(!u)throw new Error("Parsing ended without finding any IDAT chunk. Index: "+r);if(!c)throw new Error("Parsing ended without finding the IEND chunk. Index: "+r);if(t.byteLength>r)throw new Error("There are bytes left at the end of the file. Index: "+r)}function s(n){var t=r+n;if(t>e.length)throw new Error("Unexpectedly reached end of file. Index: "+r);var o=e.slice(r,t);return r=t,o}function x(r,e){var n=v(r,e);return 2147483648&n?-4294967296^n:n}function v(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}g[n]=function(e){var n=e[8],t=e[9],o=e[10],i=e[11],f=e[12];if(8!==n&&4!==n&&2!==n&&1!==n&&16!==n)throw new Error("Unsupported bit depth "+n+". Index: "+r);if(!(t in a))throw new Error("Unsupported color type. Index: "+r);if(0!==o)throw new Error("Unsupported compression method. Index: "+r);if(0!==i)throw new Error("Unsupported filter method. Index: "+r);if(0!==f&&1!==f)throw new Error("Unsupported interlace method. Index: "+r);p=t,w=!0},g[t]=function(r){c=!0},g[o]=function(e){if(p===d&&0===l.length)throw new Error("Expected palette not found. Index: "+r);u=!0},g[i]=function(r){for(var e=Math.floor(r.byteLength/3),n=0;n<e;n++)l.push([r[3*n],r[3*n+1],r[3*n+2],255])},g[f]=function(e){if(p===d){if(0===l.length)throw new Error("Transparency chunk must be after palette. Index: "+r);if(e.byteLength>l.length)throw new Error("More transparent colors than palette size. Index: "+r);for(var n=0;n<e.byteLength;n++)l[n][3]=e[n]}},g[h]=function(r){};var E=[];function y(r){for(var e=-1,n=0;n<r.length;n++)e=E[255&(e^r[n])]^e>>>8;return-1^e}!function(){for(var r=0;r<256;r++){for(var e=r,n=0;n<8;n++)1&e?e=3988292384^e>>>1:e>>>=1;E[r]=e}}();export{I as pngValidator};

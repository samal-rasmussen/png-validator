var PngValidator=function(r){"use strict";var n,e,t=1229472850,o={0:1,2:3,3:1,4:2,6:4},i=!1,f=!1,h=!1,d=[],a=0,u={};function w(r){var t=n+r;if(t>e.length)throw new Error("Unexpectedly reached end of file. Index: "+n);var o=e.slice(n,t);return n=t,o}function c(r,n){var e=l(r,n);return 2147483648&e?-4294967296^e:e}function l(r,n){return r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]}u[t]=function(r){var e=r[8],t=r[9],f=r[10],h=r[11],d=r[12];if(8!==e&&4!==e&&2!==e&&1!==e&&16!==e)throw new Error("Unsupported bit depth "+e+". Index: "+n);if(!(t in o))throw new Error("Unsupported color type. Index: "+n);if(0!==f)throw new Error("Unsupported compression method. Index: "+n);if(0!==h)throw new Error("Unsupported filter method. Index: "+n);if(0!==d&&1!==d)throw new Error("Unsupported interlace method. Index: "+n);a=t,i=!0},u[1229278788]=function(r){h=!0},u[1229209940]=function(r){if(3===a&&0===d.length)throw new Error("Expected palette not found. Index: "+n);f=!0},u[1347179589]=function(r){for(var n=Math.floor(r.byteLength/3),e=0;e<n;e++)d.push([r[3*e],r[3*e+1],r[3*e+2],255])},u[1951551059]=function(r){if(3===a){if(0===d.length)throw new Error("Transparency chunk must be after palette. Index: "+n);if(r.byteLength>d.length)throw new Error("More transparent colors than palette size. Index: "+n);for(var e=0;e<r.byteLength;e++)d[e][3]=r[e]}},u[1732332865]=function(r){};var g=[];function p(r){for(var n=-1,e=0;e<r.length;e++)n=g[255&(n^r[e])]^n>>>8;return-1^n}return function(){for(var r=0;r<256;r++){for(var n=r,e=0;e<8;e++)1&n?n=3988292384^n>>>1:n>>>=1;g[r]=n}}(),r.pngValidator=function(r){for(i=!1,f=!1,h=!1,d=[],a=0,n=0,e=r,function(){for(var r=[137,80,78,71,13,10,26,10],e=w(r.length),t=0;t<r.length;t++)if(e[t]!==r[t])throw new Error("Invalid file signature. Index: "+n)}();n<e.byteLength;){var o=l(e,n);if(n+=4,o>e.byteLength-n)throw new Error("Invalid chunk length. Index: "+n);var g=e.slice(n,n+4+o),s=l(e,n);n+=4;for(var I="",v=4;v>0;v--)I+=String.fromCharCode(e[n-v]);var x=Boolean(32&g[0]);if(!i&&s!==t)throw new Error("Expected IHDR on beggining. Index: "+n);var E=w(o),y=u[s];if(null==y){if(!x)throw new Error("Unsupported critical chunk type "+I+". Index: "+n);n+=4}else{y(E);var b=c(e,n);n+=4;var U=p(g);if(U!==b)throw new Error("Crc error - "+b+" - "+U+". Index: "+n)}}if(!i)throw new Error("Parsing ended without finding the IHDR chunk. Index: "+n);if(!f)throw new Error("Parsing ended without finding any IDAT chunk. Index: "+n);if(!h)throw new Error("Parsing ended without finding the IEND chunk. Index: "+n);if(r.byteLength>n)throw new Error("There are bytes left at the end of the file. Index: "+n)},r}({});
